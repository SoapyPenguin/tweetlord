<!DOCTYPE HTML>
<html lang="en">
<head>
	<title>Tweetlord</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="stylesheet" type="text/css" href="neon.css" title="Main Look">
	<link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Fascinate+Inline" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Erica+One" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src="/scripts/socket.io.js"></script>
</head>
<style type="text/css">
	* {

	}
</style>
<body>
	<div class="top-banner">
		<div class="banner-jt">
			<h1 class="banner-title" align="center" style="font-family:'Fascinate Inline'"><span class="btitle1">Tweet</span><span class="btitle2">lord</span></h1>
		</div>
	</div>
	<div class="container-fluid" id="game-container">
		<header>
			<nav class="navbar navbar-inverse navbar-static-top">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="http://localhost:8080/sync/lobby.php">Home</a>
				</div>
				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li class="active"><a href="#">Home</a></li>
						<li><a href="" data-toggle="modal" data-target="#about-modal">About</a></li>
						<li><a href="#">Quit</a></li>
					</ul>
				</div>
			</nav>
		</header>
		<div id="about-modal" class="modal fade" role="dialog">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">About Tweetlord</h4>
					</div>
					<div class="modal-body">
						<p>Welcome to the next generation of shitposting. You and up to 6 friends take
						turns being the 'Tweeter', or the one impersonating various renowned Twitter afficionados as
						accurately or insensitively as their heart desires, while the others play the part of the
						ravenously unforgiving comment section. Earn points by composing the funniest and
						best tweets and comments to win!</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>
  		<div class="game-content">
			<div class="ph0-content row">
				<h3 class="ph0-header">Waiting for players to join...</h3>
                <div class="ph0-pl-area col-xs-8">
  				  <ul class="ph0-playerlist">
  					 <li class="ph0-p1"><span class="ph0-listitem1"></span></li>
  					 <li class="ph0-p2"><span class="ph0-listitem2"></span></li>
  					 <li class="ph0-p3"><span class="ph0-listitem3"></span></li>
  					 <li class="ph0-p4"><span class="ph0-listitem4"></span></li>
  					 <li class="ph0-p5"><span class="ph0-listitem5"></span></li>
  					 <li class="ph0-p6"><span class="ph0-listitem6"></span></li>
  				  </ul>
                </div>
                <div class="ph0-gc col-xs-4">
                    <div class="ph0-gc-label">
                        GAME CODE: <br>
                    </div>
                    <span class="ph0-codespan label label-primary" style="font-size:1.2em;"></span>
                    <div class="ph0-tick-label">
                        START IN: <br>
                    </div>
                    <span class="ph0-tick label label-info" style="font-size:1.2em;"></span>
                    <button class="btn btn-warning btn-sm postpone-btn">Postpone</button>
                    <button class="btn btn-success btn-sm impatient-btn">I'm Impatient</button>
                </div>
			</div>
            <div class="transition-content row">
                <h3 class="transition-logo"><span class="transition-w1">Tweet</span><span class="transition-w2">lord</span></h3>
            </div>
            <div class="ph1-content row">
                <h3 class="ph1-tweeter-header col-xs-12">Tweeting as:</h3>
                <div class="ph1-tweeter"></div>
                <h3 class="ph1-prompt-header col-xs-12"></h3>
                <div class="ph1-prompt"></div>
                <div class="ph1-tweetarea">
                    <textarea rows="4" class="form-control ph1-tweetinput" maxlength="140" placeholder="Compose your tweet"></textarea>
                </div>
                <button class="btn btn-primary compose-tweet-btn">Enter</button>
                <span class="ph1-tick label label-info" style="font-size:1.2em;"></span>
            </div>
            <div class="ph1-postcontent row">
                <h3 class="transition-logo"><span class="transition-w1">Tweet</span><span class="transition-w2">lord</span></h3>
                <h2 class="ph1-pc-header">Waiting for other players...</h2>
                <span class="ph1-tick label label-info" style="font-size:1.2em;"></span>
            </div>
        </div>
    </div>
	</body>
</html>
<script type="text/javascript">
$(document).ready(function() {
    //Setup
    var localip = 'ws://localhost:8081/';
    var gameState = {};
    var playerSlot = 0;
    
    var socket = io(localip);
    socket.emit('sockettest', {
        welcome: "Socket start!"
    });

    socket.on('setup', function(data) {
        console.log("Setting up...");
        gameState = data.gameState;
        playerSlot = data.slot;
        $('.ph0-codespan').text(gameState.code);
        for(var i = 1; i < 7; i++) {
            $('.ph0-listitem' + i).text(data.gameState.players[i]);
        }
    });
    
    socket.on('playerJoin', function(data) {
        console.log(data.name + " has joined as P" + data.slot);
        for(var i = 1; i < 7; i++) {
            $('.ph0-listitem' + i).text(data.gameState.players[i]);
        }
    });
    
    //Update gameState
    function updateGame(gs) {
        gameState = gs;
    }
    
    //Ticks
    socket.on('phaseZeroTick', function(data) {
        updateGame(data.gameState);
        $('.ph0-tick').text(data.gameState.timers[0]);
    });
    
    socket.on('phaseOneTick', function(data) {
        updateGame(data.gameState);
        $('.ph1-tick').text(data.gameState.timers[1]);
    });
    
    //Transitions
    socket.on('startPhaseOne', function(data) {
        $('.ph0-content').fadeOut(function() {
            $('.transition-content').fadeIn();
            $('.ph1-tweeter').text(data.gameState.tweeters[playerSlot].name);
            $('.ph1-prompt').text(data.gameState.prompts[playerSlot]);
            setTimeout(function() {
                $('.transition-content').fadeOut(function() {
                    $('.ph1-content').fadeIn();
                });
            }, 3000);
        });
    });
    
    //Alerts
    socket.on('tooManyPostpones', function() {
        alert("Whoa there, cowboy. Let's get this show on the road.");
    });
    
    //Buttons/inputs
    $('.postpone-btn').on('click', function() {
        socket.emit('postpone');
    });
    
    $('.impatient-btn').on('click', function() {
        socket.emit('impatience');
    });
    
    $('.ph1-tweetinput').on('keyup', function(e) {
        if((e.keyCode || e.which) == 13) {
            socket.emit('composeTweet', {
                slot: playerSlot
            });
            $('.ph1-content').fadeOut(function() {
                $('.ph1-postcontent').fadeIn();
            });
        }
    });
    
    $('.compose-tweet-btn').on('click', function() {
        socket.emit('composeTweet', {
            slot: playerSlot
        });
        $('.ph1-content').fadeOut(function() {
            $('.ph1-postcontent').fadeIn();
        });
    });
});
</script>
